---
format:
  html:
    code-fold: true
    code-download: true
    code-overflow: wrap
about:
  template: jolla
  id: about-block
  image: "img/my_image.png"
  links:
    - icon: twitter
      text: Twitter
      href: https://twitter.com/MarvinSchmittML
    - icon: github
      text: Github
      href: https://github.com/marvinschmitt
    - icon: linkedin
      text: LinkedIn
      href: https://www.linkedin.com/in/marvin-schmitt-a85b321a2/
    - icon: envelope
      text: Email
      href: "mailto:mail.marvinschmitt@gmail.com"  
engine: knitr      
---

::: {#about-block}
:::

# Australian honeybee colony loss survey

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Feugiat ullamcorper nullam ac donec volutpat erat amet tempus quam cubilia egestas torquent nisi mollis lacus. Sagittis urna fringilla himenaeos est nec curabitur iaculis nisl risus amet accumsan venenatis nulla. Orci accumsan hendrerit lacus litora cras placerat et ad ligula tellus platea. Viverra interdum gravida et condimentum quis placerat integer fusce.



## Graphics

Sem iaculis porttitor pellentesque libero cras porttitor tellus ac. Ligula hendrerit praesent enim felis justo eros varius consectetur molestie. Justo suspendisse habitant nunc finibus nam.
Eleifend ad lacinia curabitur taciti amet nisl sodales suspendisse orci consectetur senectus. Eleifend convallis maximus vivamus est condimentum porta est litora litora nunc fringilla maecenas non dui. Duis diam inceptos pharetra habitasse elit nibh eget scelerisque eleifend volutpat ad venenatis tempor iaculis mollis.


# Colony losses (not real data)


```{r message=F}
#| layout-ncol: 2
 
library(sf)
library(ggplot2)
library(ggiraph)

# Load the shapefile
aus_shp <- st_read("../STE_2021_AUST_GDA2020.shx", quiet = T)[1:8,] # remove islands

# Simplify geometries with a lower tolerance and keep empty shapes
aus_shp_simplified <- st_simplify(aus_shp, dTolerance = 8000, preserveTopology = TRUE)

# Ensure geometries are valid
aus_shp_simplified <- st_make_valid(aus_shp_simplified)

# Remove empty geometries
aus_shp_simplified <- aus_shp_simplified[!st_is_empty(aus_shp_simplified), ]
# Generate random numbers between 1 and 100 for each state
set.seed(123)  # For reproducibility
aus_shp_simplified$`2024 colony losses` <- sample(1:20, nrow(aus_shp_simplified), replace = TRUE)
years <- 2020:2024
states <- c("New South Wales", "Victoria", "Queensland", "South Australia", "Western Australia", "Tasmania", "Northern Territory", "Australian Capital Territory")
n_states <- length(states)
colony_losses <- data.frame(
  state = rep(states, each = length(years)),
  year = rep(years, times = n_states),
  losses = sample(1:20, n_states * length(years), replace = TRUE)
)


# Create ggplot object with interactive elements
p <- ggplot(aus_shp_simplified) +
  geom_sf_interactive(aes(fill = `2024 colony losses`, tooltip = `2024 colony losses`, data_id = `2024 colony losses`)) +
  scale_fill_viridis_c() +
  theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),   axis.text = element_blank()) + labs(title = "2024 winter losses") + guides(fill = guide_legend(title = NULL)) 

# Render the interactive plot
girafe(
  ggobj = p,
  options = list(
    opts_hover(css = "fill:orange;"),
    opts_hover_inv(css = "opacity:0.5;"),
    opts_selection(type = "single", only_shiny = FALSE),
    opts_tooltip(css = "font-size: 20px;") 
  )
)

p_line <- ggplot(colony_losses, aes(x = year, y = losses, color = state, group = state)) +
  geom_line_interactive(aes(tooltip = paste(state, year, losses, sep = ": "), data_id = state)) +
  geom_point_interactive(aes(tooltip = paste(state, year, losses, sep = ": "), data_id = state)) +
  theme_minimal() +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14),
    legend.position = "bottom" 
  ) +
  labs(title = "Losses over 5 years", x = "Year", y = "Colony Losses") + 
  guides(color = guide_legend(title = NULL)) 

girafe(
  ggobj = p_line,
  options = list(
    opts_hover(css = "stroke-width:2;"),
    opts_hover_inv(css = "opacity:0.5;"),
    opts_selection(type = "single", only_shiny = FALSE),
    opts_tooltip(css = "font-size: 12px;")
  )
)

```
